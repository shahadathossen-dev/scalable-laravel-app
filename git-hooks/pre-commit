#!/bin/sh

echo "üîπ Running Pre-Commit Checks..."

# 1Ô∏è‚É£ Run Laravel Pint (Code Style)
if [ -f "./vendor/bin/pint" ]; then

    # 1Ô∏è‚É£ Run Laravel Pint (Code Style)
    echo "‚û°Ô∏è  Running Laravel Pint..."
    ./vendor/bin/pint

    STATUS=$?

    # ‚ùå If Pint fails, abort the commit
    if [ $STATUS -ne 0 ]; then
        echo "‚ùå Pint failed. Fix errors before committing."
        exit 1
    fi

    # 2Ô∏è‚É£ If Pint fixed files, add them to the commit
    CHANGED_FILES=$(git status --porcelain | grep -E '^[AM]' | awk '{print $2}')

    if [ -n "$CHANGED_FILES" ]; then
        echo "üîπ Adding Pint-fixed files to commit..."
        git add $CHANGED_FILES
    fi
else
    echo "‚ö†Ô∏è  Pint not found. Skipping code style checks."
fi

echo "‚úÖ Pre-commit checks completed!"
